scripted_gui = {
	state_powers_upgrade = {
	
		context_type = selected_state_context
		
		window_name = "state_powers_upgrade"
		parent_window_token = selected_state_view
			
		effects = {
			urbanization_click = {
				zz_urbanization = yes
				ROOT = {
					add_political_power = -500
				}
			}
			make_core_click = {
				ROOT = {
					add_political_power = -500
				}
				if = {
					limit = {
						is_fully_controlled_by = ROOT
						is_owned_by = ROOT
						NOT = { 
							is_core_of = ROOT
						}
					}
					add_core_of = root 	
				}
			}
			has_insurgency_click = {
			
			}
			fund_insurgency_click = {
				if = {
					limit = {
						NOT = {
							has_state_flag = active_insurgency
						}		
					}
					set_state_flag = active_insurgency

					add_state_modifier = {
						modifier = {
							local_resources = -0.20
							local_supplies = -0.30
							local_intel_to_enemies = 0.25
							local_factory_sabotage = 0.30
							local_non_core_manpower = -0.30
							attrition = 0.30
							local_org_regain = -0.25
						}
					}
				}
				
				ROOT = {
					set_state_controller = created_guerillas_state
					add_equipment_to_stockpile = {
						type = infantry_equipment
						amount = -1000
					}
				}
			}
			encourage_uprising_click = {
				set_temp_variable = { ROOT.created_guerillas_state = THIS }
				set_variable = { insur_target = THIS }
				reset_insurgency_modifiers_effect = yes
				ROOT = {
					set_state_controller = created_guerillas_state
					add_equipment_to_stockpile = {
						type = infantry_equipment
						amount = -5000
					}	
					
					country_event = insurgency_effects.1 	#add_manpower = -2000
					if = {
						limit = {
							has_country_flag = insurgency_revolution	
						}
						transfer_state = created_guerillas_state
					}
					if = {
						limit = {
							check_variable = { created_guerrillas_template = 0 }
						}
						set_variable = { ROOT.created_guerrillas_template = 1 }
						division_template = {
							name = "Guerrillas"
							regiments = {
								infantry = { x = 0 y = 0 }
								infantry = { x = 0 y = 1 }
								infantry = { x = 0 y = 2 }
							}
						}
						set_division_template_lock = { division_template = Guerrillas is_locked = yes }
					}
					var:created_guerillas_state = {
						create_unit = {
							division = "name = \"Partisan\" division_template = \"Guerrillas\" start_experience_factor = 0.3" 
							owner = ROOT
						}
						create_unit = {
							division = "name = \"Partisan\" division_template = \"Guerrillas\" start_experience_factor = 0.3" 
							owner = ROOT
						}
						create_unit = {
							division = "name = \"Partisan\" division_template = \"Guerrillas\" start_experience_factor = 0.3" 
							owner = ROOT
						}
					}
				}				
			}
			raid_insurgent_bases_click = {
				ROOT = { 
					add_timed_idea = {
						idea = cooldown_for_insurgent_attacks
						days = 50
					}
				}	
				set_variable = { insur_target = THIS }
				country_event = insurgency_effects.2
				subtract_from_variable = { insurgency_strength = 3 }
			}
			arial_bombardment_on_insurgent_bases_click = {
				ROOT = { 
					add_timed_idea = {
						idea = cooldown_for_insurgent_attacks
						days = 50
					}
				}
				set_variable = { insur_target = THIS }
				country_event = insurgency_effects.3 
				subtract_from_variable = { insurgency_strength = 5 }
			}
			launch_helicoptor_raids_on_insurgent_bases_click = {
				ROOT = { 
					add_timed_idea = {
						idea = cooldown_for_insurgent_attacks
						days = 50
					}
				}	
				set_variable = { insur_target = THIS }
				country_event = insurgency_effects.2
				subtract_from_variable = { insurgency_strength = 5 }
			}
			sarin_attack_on_insurgents_click = {
				ROOT = { 
					add_timed_idea = {
						idea = cooldown_for_insurgent_attacks
						days = 50
					}
				}	
				set_variable = { insur_target = THIS }
				country_event = insurgency_effects.4
				add_threat = 10
				subtract_from_variable = { insurgency_strength = 15 }
				add_equipment_to_stockpile = { type = sarin_1 amount = -50  }
			}
			mustard_gas_attack_on_insurgents_click = {
				ROOT = { 
					add_timed_idea = {
						idea = cooldown_for_insurgent_attacks
						days = 50
					}
				}	
				set_variable = { insur_target = THIS }
				country_event = insurgency_effects.5
				add_threat = 5
				subtract_from_variable = { insurgency_strength = 8 }
				add_equipment_to_stockpile = { type = chemical_weapons_1 amount = -50  }
			}
			false_flag_click = {
				ROOT = { 
					add_timed_idea = {
						idea = cooldown_for_insurgent_attacks
						days = 100
					}
				}	
				set_variable = { insur_target = THIS }
				country_event = insurgency_effects.3
				subtract_from_variable = { insurgency_strength = 2 }
				add_war_support = 0.10
			}

			
		}
		
		triggers = {
			false_flag_visible = {
				has_state_flag = active_insurgency
				is_fully_controlled_by = ROOT
				is_owned_by = ROOT 
			}
			false_flag_click_enabled = {
				NOT = {
					has_idea = cooldown_for_insurgent_attacks
				}
				has_state_flag = active_insurgency
				is_fully_controlled_by = ROOT
				is_owned_by = ROOT 
				has_army_size = {
					size > 5
				}
			}
			raid_insurgent_bases_click_enabled = {
				NOT = {
					has_idea = cooldown_for_insurgent_attacks
				}
				has_state_flag = active_insurgency
				is_fully_controlled_by = ROOT
				is_owned_by = ROOT 
				has_army_size = {
					size > 5
				}
			}
			arial_bombardment_on_insurgent_bases_click_enabled = {
				NOT = {
					has_idea = cooldown_for_insurgent_attacks
				}
				has_state_flag = active_insurgency
				is_fully_controlled_by = ROOT
				is_owned_by = ROOT 
				OR = {
					has_deployed_air_force_size = {
						size > 20
						type = strategic_bomber
					} 
					has_deployed_air_force_size = {
						size > 20
						type = tactical_bomber
					} 
				}
			}
			launch_helicoptor_raids_on_insurgent_bases_visible = {
				has_state_flag = active_insurgency
				is_fully_controlled_by = ROOT
				is_owned_by = ROOT 
			}
			launch_helicoptor_raids_on_insurgent_bases_click_enabled = {
				NOT = {
					has_idea = cooldown_for_insurgent_attacks
				}
				has_state_flag = active_insurgency
				is_fully_controlled_by = ROOT
				is_owned_by = ROOT 
				ROOT = {
					has_equipment = { attack_helicopter_equipment > 50 }
					has_tech = attack_helicopter_1
				}		
			}
			mustard_gas_attack_on_insurgents_visible = {
				has_state_flag = active_insurgency
				is_fully_controlled_by = ROOT
				is_owned_by = ROOT 
			}
			mustard_gas_attack_on_insurgents_click_enabled = {
				NOT = {
					has_idea = cooldown_for_insurgent_attacks
				}
				ROOT = {
					has_equipment = { chemical_weapons_1 > 50 }
					has_tech = chemical_weapons
				}		
			}
			sarin_attack_on_insurgents_click_enabled = {
				NOT = {
					has_idea = cooldown_for_insurgent_attacks
				}
				ROOT = {
					has_equipment = { sarin_1 > 50 }
					has_tech = chemical_weapons_3
				}		
			}
			raid_insurgent_bases_visible = {
				has_state_flag = active_insurgency
				is_fully_controlled_by = ROOT
				is_owned_by = ROOT 
			}
			arial_bombardment_on_insurgent_bases_visible = {
				has_state_flag = active_insurgency
				is_fully_controlled_by = ROOT
				is_owned_by = ROOT 
			}
			sarin_attack_on_insurgents_visible = {
			#	has_state_flag = active_insurgency
				is_fully_controlled_by = ROOT
				is_owned_by = ROOT 
			}

			has_insurgency_visible = {
				has_state_flag = active_insurgency
			}
			encourage_uprising_visible = {
				has_state_flag = active_insurgency
				is_core_of = ROOT
			}
			encourage_uprising_click_enabled = {
				any_country = {
					controls_state = THIS
					has_war_with = ROOT
				}		
				OR = {
					check_variable = { var = insurgency_strength value = 150 compare = greater_than_or_equals }
					ROOT = { 
						has_country_flag = insurgency_revolution
					}
				}
			}
			fund_insurgency_visible = {
				is_core_of = ROOT
				
				NOT = { has_state_flag = active_insurgency }
				NOT = { is_fully_controlled_by = ROOT }
				NOT = { is_owned_by = ROOT }	
				ROOT = {
					has_manpower = 1000
					has_equipment  = {
						type = infantry_equipment
						amount = 1000
					}					
				}
			}

			urbanization_click_enabled = {
				root = {
					has_political_power > 500
				}
			}			
	
			make_core_visible = {
				is_fully_controlled_by = ROOT
				is_owned_by = ROOT
				NOT = { 
					is_core_of = ROOT
				}
			}
			make_core_click_enabled = {
				is_fully_controlled_by = ROOT
				is_owned_by = ROOT
				NOT = { 
					is_core_of = ROOT
				}
				root = {
					has_political_power > 500
				}
			}
		}
		
		ai_test_parent = ""
		
		ai_test_scopes = test_self_controlled_states
		
		ai_enabled = {
            always = no
		}
        
		ai_check = {
		}
		
		ai_weights = {
		}
	}
}